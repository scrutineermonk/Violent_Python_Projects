# -*- coding: utf-8 -*-
"""
@author: scrutineermonk
"""

import socket
import sys
import os

def retBanner(ip, port):
    try:
        socket.setdefaulttimeout(2)
        s=socket.socket()
        s.connect((ip,port))
        banner=s.recv(1024)
        return banner
    except Exception as error:
        print("[-] Error "+str(error))
        return

def checkVul(banner, filename):
    banner1=str(banner)
    print("[+] Reading Vulnerabilities From: "+filename)
    f=open(filename,'r')
    for line in f.readlines():
        if line.strip('\n') in banner1:
            print("Server Is Vulnerable " + banner1[2:len(banner1)])
            return
    print("Server is not Vulnerable")
    return


def main():
    print("Welcome to Vulnerability Scanner 101")
    # we need to provide full path of file name in which banner details are given of vulnerable services in argument
    # python scanner.py  C:/user/vi/bannername.txt
    if len(sys.argv)==2:
        filename=sys.argv[1]
        if not os.path.isfile(filename):
            print("[-] "+filename +" does not exist")
            exit(0)
        if not os.access(filename, os.R_OK):
            print("[-] "+filename+ " access denied")
            exit(0)
        print("[-] Usage: "+str(sys.argv[0])+" <vuln filename>")
        portList=[21,22,23,445,80]  ## Change the list of ports you want to scan
        print(str(filename))
        for x in range(1,30):
            ip='192.168.0.'+str(x)
            for port in portList:
                print("Checking for "+ip+":"+str(port))
                banner=retBanner(ip,port)
                if banner:
                    checkVul(banner,filename)

if __name__ == '__main__':
    main()
        VulnerabilityScannerBETA.py
